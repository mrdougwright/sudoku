defmodule SudokuTest do
  use ExUnit.Case
  doctest Sudoku

  setup do
    grids()
  end

  describe "valid_rows?/1" do
    test "returns true for valid rows", %{valid: grid} do
      random_grid = Enum.random(grid)
      assert Sudoku.valid_rows?(random_grid) == true
    end

    test "returns false for invalid row", %{invalid: bad_grids} do
      random_grid = bad_grids |> List.last()
      assert Sudoku.valid_rows?(random_grid) == false
    end
  end

  test "valid_columns?", %{valid: grid} do
    random_grid = Enum.random(grid)
    assert Sudoku.valid_columns?(random_grid) == true
  end

  test "valid_sub_grids?", %{valid: grid} do
    random_grid = Enum.random(grid)
    assert Sudoku.valid_sub_grids?(random_grid) == true
  end

  def grids do
    valid = [
      [
        ['.', '.', '.', '1', '4', '.', '.', '2', '.'],
        ['.', '.', '6', '.', '.', '.', '.', '.', '.'],
        ['.', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['.', '.', '1', '.', '.', '.', '.', '.', '.'],
        ['.', '6', '7', '.', '.', '.', '.', '.', '9'],
        ['.', '.', '.', '.', '.', '.', '8', '1', '.'],
        ['.', '3', '.', '.', '.', '.', '.', '.', '6'],
        ['.', '.', '.', '.', '.', '7', '.', '.', '.'],
        ['.', '.', '.', '5', '.', '.', '.', '7', '.']
      ],
      # Valid
      [
        ['1', '2', '3', '.', '.', '.', '.', '.', '.'],
        ['.', '.', '.', '.', '7', '.', '.', '.', '.'],
        ['4', '5', '6', '.', '.', '.', '.', '.', '.'],
        ['.', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['.', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['.', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['.', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['.', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['.', '.', '.', '.', '.', '.', '.', '.', '.']
      ],
      # Valid
      [
        ['1', '2', '3', '4', '5', '6', '7', '8', '9'],
        ['4', '5', '6', '7', '8', '9', '1', '2', '3'],
        ['7', '8', '9', '1', '2', '3', '4', '5', '6'],
        ['2', '3', '4', '5', '6', '7', '8', '9', '1'],
        ['5', '6', '7', '8', '9', '1', '2', '3', '4'],
        ['8', '9', '1', '2', '3', '4', '5', '6', '7'],
        ['3', '4', '5', '6', '7', '8', '9', '1', '2'],
        ['6', '7', '8', '9', '1', '2', '3', '4', '5'],
        ['9', '1', '2', '3', '4', '5', '6', '7', '8']
      ]
    ]

    invalid = [
      # Invalid
      [
        ['1', '2', '3', '4', '5', '6', '6', '8', '9'],
        ['4', '5', '6', '.', '.', '.', '.', '.', '.'],
        ['7', '8', '9', '.', '.', '.', '.', '.', '.'],
        ['2', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['5', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['8', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['3', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['6', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['9', '.', '.', '.', '.', '.', '.', '.', '.']
      ],
      # Invalid
      [
        ['1', '2', '3', '4', '5', '6', '7', '8', '9'],
        ['4', '5', '6', '.', '.', '.', '.', '.', '.'],
        ['7', '8', '9', '.', '.', '.', '.', '.', '.'],
        ['2', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['5', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['3', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['3', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['6', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['9', '.', '.', '.', '.', '.', '.', '.', '.']
      ],
      # Invalid
      [
        ['1', '2', '3', '4', '5', '6', '7', '8', '9'],
        ['4', '5', '8', '.', '.', '.', '.', '.', '.'],
        ['7', '8', '9', '.', '.', '.', '.', '.', '.'],
        ['2', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['5', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['8', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['3', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['6', '.', '.', '.', '.', '.', '.', '.', '.'],
        ['9', '.', '.', '.', '.', '.', '.', '.', '.']
      ],
      # Invalid
      [
        ['1', '2', '8', '4', '5', '6', '7', '8', '9'],
        ['4', '7', '6', '7', '8', '9', '1', '2', '3'],
        ['7', '8', '9', '1', '2', '3', '4', '5', '6'],
        ['2', '3', '4', '5', '6', '7', '8', '9', '1'],
        ['5', '6', '7', '8', '9', '1', '2', '3', '4'],
        ['8', '9', '1', '2', '3', '4', '5', '6', '7'],
        ['3', '4', '5', '6', '7', '8', '9', '1', '2'],
        ['6', '7', '8', '9', '1', '2', '3', '4', '5'],
        ['9', '1', '2', '3', '4', '5', '6', '7', '8']
      ]
    ]

    %{valid: valid, invalid: invalid}
  end
end
